// === SheetJS In-Memory Parse Test ===

// 1. Build a simple workbook
const wb = XLSX.utils.book_new();
const ws = XLSX.utils.aoa_to_sheet([
  ["Name", "Age"],
  ["Alice", 30],
  ["Bob", 25]
]);
XLSX.utils.book_append_sheet(wb, ws, "Sheet1");

// 2. Generate ArrayBuffer
const wbout = XLSX.write(wb, { bookType: "xlsx", type: "array" });

// 3. Try to re-parse it in memory
try {
  const parsed = XLSX.read(wbout, { type: "array" });

  console.log("✅ In-memory parse succeeded.");
  console.log("Sheets in workbook:", parsed.SheetNames);
  console.log("First sheet data:", XLSX.utils.sheet_to_json(parsed.Sheets[parsed.SheetNames[0]], { header: 1 }));
} catch (err) {
  console.error("❌ In-memory parse failed:", err);
}